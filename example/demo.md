# 功能演示指南

## 🎬 完整功能演示流程

### 准备工作

1. 确保扩展已正确加载
2. 打开一个网页（如 `https://www.google.com`）
3. 打开开发者工具（F12）
4. 点击扩展图标打开侧边栏

### 演示步骤

#### 第一步：基础消息传递测试

1. **点击"📤 测试消息"按钮**
   - 观察页面右上角出现蓝色通知
   - 查看侧边栏显示的处理结果
   - 在控制台查看详细日志

**预期效果**：

- 页面显示："收到消息: 来自 ExamplePluginService 的消息"
- 侧边栏显示成功状态和响应数据
- 控制台显示完整的消息传递过程

#### 第二步：标签页信息获取

2. **点击"📋 获取标签页信息"按钮**
   - 查看返回的标签页详细信息
   - 验证 URL、标题等信息正确

**预期效果**：

```json
{
  "tabId": 123,
  "url": "https://www.google.com",
  "title": "Google",
  "status": "complete",
  "timestamp": "2024-01-01T12:00:00.000Z"
}
```

#### 第三步：数据存储测试

3. **点击"💾 存储数据"按钮**

   - 将测试数据存储到 Chrome 本地存储
   - 观察存储成功的确认信息

4. **点击"📖 获取存储数据"按钮**
   - 从存储中读取刚才保存的数据
   - 验证数据完整性

**预期效果**：

- 存储成功显示确认信息
- 读取的数据包含原始消息、时间戳和随机值

#### 第四步：直接 Content 通信

5. **点击"📨 向 Content 发送消息"按钮**
   - 观察页面右上角出现绿色通知
   - 与蓝色通知区分不同的消息来源

**预期效果**：

- 页面显示："Sidepanel: 来自 Sidepanel 的消息"
- 绿色背景区别于蓝色通知

#### 第五步：页面信息分析

6. **点击"🌐 获取页面信息"按钮**
   - 获取当前页面的详细信息
   - 包括 URL、标题、Meta 标签、DOM 统计等

**预期效果**：

```json
{
  "url": "https://www.google.com",
  "title": "Google",
  "domain": "www.google.com",
  "pathname": "/",
  "meta": {
    "description": "Search the world's information...",
    "viewport": "width=device-width,initial-scale=1"
  },
  "domStats": {
    "totalElements": 150,
    "links": 20,
    "images": 5,
    "forms": 1
  }
}
```

#### 第六步：脚本注入演示

7. **点击"🔧 注入脚本"按钮**
   - 观察页面边框变为蓝色
   - 3秒后边框自动消失
   - 查看控制台输出

**预期效果**：

- 页面立即出现蓝色边框
- 控制台显示："这是从 Sidepanel 注入的脚本"
- 3秒后边框自动消失

#### 第七步：数据清理

8. **点击"🗑️ 清除存储数据"按钮**
   - 清除之前存储的测试数据
   - 验证数据已被删除

**预期效果**：

- 显示清除成功的确认信息
- 再次点击"获取存储数据"显示空值

## 🔍 观察要点

### 消息传递流程

1. **Sidepanel → Background**: 用户点击按钮
2. **Background → Content**: Background 调用 Content Script
3. **Content → Background**: Content Script 返回响应
4. **Background → Sidepanel**: 显示最终结果

### 通知效果

- **蓝色通知**: 来自 Background 的消息
- **绿色通知**: 来自 Sidepanel 的直接消息

### 控制台日志

- 每个步骤都有详细的控制台输出
- 可以观察到完整的消息传递过程
- 包含错误处理和状态信息

## 🎯 高级演示

### 多标签页测试

1. 打开多个不同的网页
2. 在每个页面测试功能
3. 观察消息只在当前活动标签页生效

### 错误处理测试

1. 在 chrome:// 页面测试（应该失败）
2. 观察错误信息的显示
3. 验证错误处理机制

### 数据持久化测试

1. 存储数据后关闭浏览器
2. 重新打开浏览器
3. 验证数据仍然存在

## 📊 性能观察

### 响应时间

- 基础消息传递：通常 < 100ms
- 页面信息获取：通常 < 200ms
- 脚本注入：通常 < 50ms

### 内存使用

- 观察扩展的内存占用
- 验证没有内存泄漏

## 🎉 演示总结

通过这个完整的演示，你可以看到：

1. **完整的消息传递机制**
2. **多种通信方式**
3. **数据存储和管理**
4. **页面交互能力**
5. **错误处理机制**
6. **用户界面反馈**

这个示例展示了 Chrome 扩展开发的核心概念和最佳实践，可以作为开发其他扩展的参考模板。
